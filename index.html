<!DOCTYPE html>
<html>
<head>
  <title>Photo Upload to Google Drive</title>
</head>
<body>
  <h2>Upload Photo to Google Drive</h2>
  <input type="file" id="fileInput" accept="image/*">
  <button onclick="uploadPhoto()">Upload</button>
  <p id="status"></p>
  
<script>
  async function uploadPhoto() {
    const fileInput = document.getElementById("fileInput");
    const file = fileInput.files[0];

    if (!file) {
      alert("Please select a file.");
      return;
    }

    const reader = new FileReader();
    reader.onload = async function (e) {
      const base64Data = e.target.result.split(",")[1];

      const payload = `filename=${encodeURIComponent(file.name)}&mimeType=${encodeURIComponent(file.type)}&base64=${encodeURIComponent(base64Data)}`;

      try {
        const res = await fetch("https://script.google.com/macros/s/AKfycbywCLoSJG-3QHc7jmHVnu6j2q1TXNXyTZ4G8QYv14zUz5aVEMwD8vTrngZXq3JfMenUWQ/exec", {
          method: "POST",
          headers: {
            "Content-Type": "application/x-www-form-urlencoded"
          },
          body: payload
        });

        const text = await res.text();
        document.getElementById("status").innerText = text;

        // Reload after 3 seconds
        setTimeout(() => location.reload(), 3000);

      } catch (err) {
        document.getElementById("status").innerText = "‚ùå Request failed: " + err.message;
      }
    };

    reader.readAsDataURL(file);
  }
</script>
</body>
</html>
